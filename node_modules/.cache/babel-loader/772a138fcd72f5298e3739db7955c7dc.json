{"remainingRequest":"/home/nick/Документы/front/node_modules/babel-loader/lib/index.js!/home/nick/Документы/front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/nick/Документы/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nick/Документы/front/src/components/order/ShowCurrentOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/nick/Документы/front/src/components/order/ShowCurrentOrder.vue","mtime":1550431439556},{"path":"/home/nick/Документы/front/node_modules/cache-loader/dist/cjs.js","mtime":1550345624276},{"path":"/home/nick/Документы/front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/nick/Документы/front/node_modules/cache-loader/dist/cjs.js","mtime":1550345624276},{"path":"/home/nick/Документы/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { HTTP } from '@/util/http';\nimport toast from '@/util/toast';\nimport EditOrder from '@/components/order/EditOrder.vue';\nexport default {\n  name: \"order\",\n  components: {\n    EditOrder: EditOrder\n  },\n  props: ['order'],\n  data: function data() {\n    return {\n      editing: false,\n      uid: localStorage.getItem('UID'),\n      username: ''\n    };\n  },\n  methods: {\n    deleteOrder: function deleteOrder() {\n      var _this = this;\n\n      var retry = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var orderUID = this.order.UID;\n      HTTP.delete('taxi/order/' + this.order.UID, {\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('accessToken')\n        }\n      }).then(function () {\n        toast.success('Order canceled');\n\n        _this.$parent.deleteOrder(orderUID);\n      }).catch(function (error) {\n        if (retry && error.response.status === 403) {\n          _this.handle403(function () {\n            return _this.deleteOrder(retry = false);\n          });\n        }\n\n        toast.error(error.message);\n      });\n    },\n    payOrder: function payOrder() {\n      var _this2 = this;\n\n      var retry = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var orderUID = this.order.UID;\n      HTTP.patc('taxi/payment/' + this.order.UID, {\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('accessToken')\n        }\n      }).then(function () {\n        toast.success('Pay success');\n\n        _this2.$parent.deleteOrder(orderUID);\n      }).catch(function (error) {\n        if (retry && error.response.status === 403) {\n          _this2.handle403(function () {\n            return _this2.payOrder(retry = false);\n          });\n        }\n\n        toast.error(error.message);\n      });\n    },\n    showEditForm: function showEditForm() {\n      this.editing = true;\n    },\n    closeEditForm: function closeEditForm() {\n      this.editing = false;\n    },\n    handle403: function handle403(func) {\n      if (localStorage.getItem('refreshToken')) {\n        this.$store.dispatch('refresh');\n        func();\n      } else {\n        this.$store.dispatch('logout');\n        this.$router.push('/login/');\n      }\n    }\n  }\n};",{"version":3,"sources":["ShowCurrentOrder.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqFA,SAAA,IAAA,QAAA,aAAA;AACA,OAAA,KAAA,MAAA,cAAA;AAEA,OAAA,SAAA,MAAA,kCAAA;AAGA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA;AADA,GAFA;AAMA,EAAA,KAAA,EAAA,CAAA,OAAA,CANA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,OAAA,EAAA,KADA;AAEA,MAAA,GAAA,EAAA,YAAA,CAAA,OAAA,CAAA,KAAA,CAFA;AAGA,MAAA,QAAA,EAAA;AAHA,KAAA;AAKA,GAbA;AAcA,EAAA,OAAA,EAAA;AACA,IAAA,WADA,yBACA;AAAA;;AAAA,UAAA,KAAA,uEAAA,IAAA;AACA,UAAA,QAAA,GAAA,KAAA,KAAA,CAAA,GAAA;AACA,MAAA,IAAA,CAAA,MAAA,CAAA,gBAAA,KAAA,KAAA,CAAA,GAAA,EAAA;AAAA,QAAA,OAAA,EAAA;AAAA,2BAAA,YAAA,YAAA,CAAA,OAAA,CAAA,aAAA;AAAA;AAAA,OAAA,EACA,IADA,CACA,YAAA;AACA,QAAA,KAAA,CAAA,OAAA,CAAA,gBAAA;;AACA,QAAA,KAAA,CAAA,OAAA,CAAA,WAAA,CAAA,QAAA;AACA,OAJA,EAKA,KALA,CAKA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,IAAA,KAAA,CAAA,QAAA,CAAA,MAAA,KAAA,GAAA,EAAA;AACA,UAAA,KAAA,CAAA,SAAA,CAAA;AAAA,mBAAA,KAAA,CAAA,WAAA,CAAA,KAAA,GAAA,KAAA,CAAA;AAAA,WAAA;AACA;;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,KAAA,CAAA,OAAA;AACA,OAVA;AAWA,KAdA;AAeA,IAAA,QAfA,sBAeA;AAAA;;AAAA,UAAA,KAAA,uEAAA,IAAA;AACA,UAAA,QAAA,GAAA,KAAA,KAAA,CAAA,GAAA;AACA,MAAA,IAAA,CAAA,IAAA,CAAA,kBAAA,KAAA,KAAA,CAAA,GAAA,EAAA;AAAA,QAAA,OAAA,EAAA;AAAA,2BAAA,YAAA,YAAA,CAAA,OAAA,CAAA,aAAA;AAAA;AAAA,OAAA,EACA,IADA,CACA,YAAA;AACA,QAAA,KAAA,CAAA,OAAA,CAAA,aAAA;;AACA,QAAA,MAAA,CAAA,OAAA,CAAA,WAAA,CAAA,QAAA;AACA,OAJA,EAKA,KALA,CAKA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,IAAA,KAAA,CAAA,QAAA,CAAA,MAAA,KAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,SAAA,CAAA;AAAA,mBAAA,MAAA,CAAA,QAAA,CAAA,KAAA,GAAA,KAAA,CAAA;AAAA,WAAA;AACA;;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,KAAA,CAAA,OAAA;AACA,OAVA;AAWA,KA5BA;AA8BA,IAAA,YA9BA,0BA8BA;AACA,WAAA,OAAA,GAAA,IAAA;AACA,KAhCA;AAiCA,IAAA,aAjCA,2BAiCA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KAnCA;AAoCA,IAAA,SApCA,qBAoCA,IApCA,EAoCA;AACA,UAAA,YAAA,CAAA,OAAA,CAAA,cAAA,CAAA,EAAA;AACA,aAAA,MAAA,CAAA,QAAA,CAAA,SAAA;AACA,QAAA,IAAA;AACA,OAHA,MAGA;AACA,aAAA,MAAA,CAAA,QAAA,CAAA,QAAA;AACA,aAAA,OAAA,CAAA,IAAA,CAAA,SAAA;AACA;AACA;AA5CA;AAdA,CAAA","sourcesContent":["<template>\n    <div class=\"container mt-4\">\n\n        <table class=\"table table-bordered mt-4\">\n            <thead class=\"thead-light\">\n            <tr>\n                <th width=\"10%\">ID Order</th>\n                <th width=\"10%\">Driver Name</th>\n                <th width=\"10%\">Time</th>\n                <th width=\"10%\">From Address</th>\n                <th width=\"10%\">To Address</th>\n                <th width=\"10%\">Cost</th>\n                <th width=\"10%\">Status</th>\n                <th width=\"150\">Action</th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr>\n                <td>\n                    <div>\n                    <template > {{ order.UID }}\n                        <span >{{ item.code ===order.UID}}</span>\n                    </template>\n                        </div>\n                </td>\n                <td>\n                    <div>\n                    <template > {{ order.driver_name }}\n                        <span >{{ item.driver_name === order.driver_name}}</span>\n                    </template>\n                        </div>\n                </td>\n                <td>\n                    <div>\n                    <template > {{ order.time }}\n                        <span >{{ item.time ===order.time}}</span>\n                    </template>\n                        </div>\n                </td>\n                <td>\n                    <div>\n                    <template > {{ order.from_address }}\n                        <span >{{ item.from_address ===order.from_address}}</span>\n                    </template>\n                        </div>\n                </td>\n                <td>\n                    <div>\n                    <template > {{ order.to_address }}\n                        <span >{{ item.to_address ===order.to_address}}</span>\n                    </template>\n                        </div>\n                </td>\n                <td>\n                    <div>\n                    <template > {{ order.cost }}\n                        <span >{{ item.cost ===order.cost}}</span>\n                    </template>\n                        </div>\n                </td>\n\n                <td>\n                    <div>\n                    <template > {{ order.order_status }}\n                        <span >{{ order.order_status}}</span>\n                    </template>\n                    </div>\n                </td>\n                <td>\n            <span>\n              <button @click=showEditForm class=\"button button-outline\" >Edit</button>\n              <button @click=deleteOrder class=\"button button-outline\" >Cancel a Taxi</button>\n              <button @click=payOrder class=\"button button-outline\">Pay Taxi</button>\n            </span>\n            <div class=\"row\" v-if=\"editing\">\n                <EditOrder :order=\"order\"></EditOrder>\n            </div>\n\n                </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n</template>\n<script>\nimport {HTTP} from '@/util/http'\nimport toast from '@/util/toast'\n\nimport EditOrder from '@/components/order/EditOrder.vue'\n\n\nexport default {\n    name: \"order\",\n    components: {\n        EditOrder\n    },\n\n    props: ['order'],\n    data () {\n        return {\n            editing: false,\n            uid: localStorage.getItem('UID'),\n            username: ''\n        }\n    },\n    methods: {\n        deleteOrder(retry=true) {\n            var orderUID = this.order.UID\n            HTTP.delete('taxi/order/' + this.order.UID, {headers: {'Authorization': 'Bearer ' + localStorage.getItem('accessToken')}})\n                .then(() => {\n                    toast.success('Order canceled')\n                    this.$parent.deleteOrder(orderUID)\n                })\n                .catch(error => {\n                    if (retry && error.response.status === 403) {\n                        this.handle403(() => this.deleteOrder(retry=false))\n                    }\n                    toast.error(error.message)\n                })\n        },\n        payOrder (retry=true){\n            var orderUID = this.order.UID\n            HTTP.patc('taxi/payment/' + this.order.UID, {headers: {'Authorization': 'Bearer ' + localStorage.getItem('accessToken')}})\n                .then(() => {\n                    toast.success('Pay success')\n                    this.$parent.deleteOrder(orderUID)\n                })\n                .catch(error => {\n                    if (retry && error.response.status === 403) {\n                        this.handle403(() => this.payOrder(retry=false))\n                    }\n                    toast.error(error.message)\n                })\n        },\n\n        showEditForm() {\n            this.editing = true\n        },\n        closeEditForm() {\n            this.editing = false\n        },\n        handle403(func) {\n            if (localStorage.getItem('refreshToken')) {\n                this.$store.dispatch('refresh')\n                func()\n            } else {\n                this.$store.dispatch('logout')\n                this.$router.push('/login/')\n            }\n        },\n    }\n}\n</script>\n\n"],"sourceRoot":"src/components/order"}]}